<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/integration"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:int="http://www.springframework.org/schema/integration"
             xmlns:task="http://www.springframework.org/schema/task"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
                  http://www.springframework.org/schema/beans/spring-beans.xsd
                  http://www.springframework.org/schema/integration
                  http://www.springframework.org/schema/integration/spring-integration.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd">

    <int:channel id="filtered"/>
    <int:channel id="enriched"/>

    <int:header-enricher input-channel="filtered" output-channel="enriched">
        <int:correlation-id value="event"/>
    </int:header-enricher>
    <int:channel id="aggregated"/>
<int:aggregator message-store="messageStore" input-channel="enriched" output-channel="aggregated" release-strategy-expression="size() == 25" send-partial-result-on-expiry="true">

</int:aggregator>
<beans:bean id="messageStore" class="org.springframework.integration.store.SimpleMessageStore"/>

    <beans:bean id="messageStoreReaper" class="org.springframework.integration.store.MessageGroupStoreReaper">
        <beans:property name="messageGroupStore" ref="messageStore"/>
        <beans:property name="timeout" value="10000"/>

    </beans:bean>



<task:scheduled-tasks>
    <task:scheduled ref="messageStoreReaper" method="run" fixed-rate="2000"/>
</task:scheduled-tasks>


</beans:beans>
